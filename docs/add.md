# Additions

## Add Command

The `add` command adds additional components to the developement environment.

```
pyde add <add sub command>
```

**e.g.**

```
pyde add model <model_name>
```

Add a new data model file to define a `JsonModel` model class to the root module of the development environment

The `add` command is a group command and includes the following sub commands.

Sub Command | Description
------------|-------------------
model       | Add a model class to the development environment
api-models  | Add all the component schemas defined in the supplied OpenApi `JSON` or `YAML` document.

### Add Model Command

The `add model <model_name>` command creates a model class for the model `model_name` in the root module of the development project.

The model classes are created in the python module `model` as a sub module of the `<root module>` of the development project.
If the `model` sub module does not exist then the `model` module is automatically created.

The `model` sub module is a python barrel of all the defined model classes.

`pyde` dynamically maintains the `model` sub module by adding new model classes to the barrel when they are added with the `pyde add model <model_name>` command.

If an OpenApi document has been loaded into the `pyde` command then if the given model `model_name` is a schema in the `components.schemas` dictionary of the OpenApi document the model class is added with the properties defined in the OpenApi document.
If the given `model_name` does not exist in the supplied OpenApi or no OpenApi is supplied then the model class is created and added to the model barrel but no properties are added to the model class.
Properties will need to be added to the new model class manually.

Arguments  | Description
-----------|------------------
model_name | The name of the model to add to the development project.

The name of the model class created by the `add model` command is generated from the given `model_name`. The model class name is generated by converting the given model name to `Class Case`
The name of the package containing the model class is generated from the given `model_name`. The model class module name is generated by converting the given model name to `Snake Case`

**e.g.**
The model name `Pet_Types` would have the class name `PetTypes` and a module name `pet_types`

And

The model name `pet_types` would have the class name `PetTypes` and a module name `pet_types`

The `add model <model_name>` command includes the following options:

Options       | Description
--------------|-------------------
--replace     | By default the add model method not overwrite an existing model class module. The `--replace` option overrides this behaviour and overwrites existing model class modules
--echo        | This option causes the add model command to echo out the contents of the model class module that was written by the add model command. The default behaviour is to not echo the contents of the generated model class modules.
--cascade     | By default adding a new module which matches a schema in the given OpenApi document will only create the model class given on the command line. If the matching schema includes references to other schemas in the OpenApi document these referenced models can be automcatically included in the development project by adding the `--cascade` option.
--show-schema | By default the the add model method does not echo out the schema definition it is using to define the properties of the added model. The behaviour can be changed by specifying the `--show-schema` option. This is useful for debugging the `add model` command.

If the matched schema in the OpenApi document defines embedded schemas. i.e. schemas which are not referenced to contents of the `components.schemas` dictionary of the OpenApi document then these embedded schemas are included in the generated model class module.

If the matched schema or embedded schemas include properties which are enumerations then the generated model class module will include a `<PropertyName>Types` enumeration class with enumeration values defined for all the values given in the OpenApi document.

The embedded schemas found for a generated model class are not included in the model barrel and cannot therefore be accessed via the `<root module>.model` module. This is because the name of the embedded schema models are not expected to be unique across all models defined in the OpenApi document. 

**e.g.**

The command:

```
pyde --api=MyOpenApi.yaml add model --replace --echo --cascade foo
```

Will

1. Load the OpenApi document `MyOpenApi.yaml` as a `YAML` file and is expected to conform to the OpenApi version 3 schema.

1. Extract the schema named `foo` from `components.schemas` in the OpenApi document and use it to generate the `Foo` model class.

1. Replace the contents of `<root module>/model/foo.py` with the generated `Foo` model class.

1. Ensure that the `Foo` model class is included in the barrel at `<root module>.model`

1. Echo out the contents of the generated model class module.

1. Add additional model as required for referenced models in the `Foo` model class and in any embedded schemas and referenced schemas


### Add Api Models Command

The add api-models command adds all the schemas defined in the given OpenApi document to the `<root module>`

The add api-models command adds model with the same functionality as the `add model <model_name>` command.

If no OpenApi docuemnt is loaded then a ValueError is raised and no changes are made.

The add api-models command includes the following options:

Options   | Description
----------|-------------------
--replace | By default the add model method not overwrite an existing model class module. The `--replace` option overrides this behaviour and overwrites existing model class modules
--echo    | This option causes the add model command to echo out the contents of the model class module that was written by the add model command. The default behaviour is to not echo the contents of the generated model class modules.


















